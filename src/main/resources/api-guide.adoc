= Rest Api Docs 
docs
v1.0 , 2016-10-24
:toc: left
:toc-title: Навигация 
В данной документации описаны основные методы и способы работы с rest api

== 1 Введение
	
Работа с апи состоит из основных следующих модулей: 

. *Авторизация* +
	Получение токена на основе существующей записи, либо создав новую запись
. *Пользователи* +
	Получение информации о пользователях,создание новых , изменение существующих 
. *Контакты* +
	Получение списка контактов
. *Сообщения* +
	Получения и отправка сообщений

Сервис авторизации не требует особых требований безопасности,в то время как остальные сервисы требуют 
хедера AccessToken, который необходимо получить в процессе авторизации
	
	
== 2 Авторизация

Авторизация доступна по адресу /api/v1/auth 
В процессе аутентификации необходимо получить токен доступа, для работы с другими ресурсами

=== 2.1 Создание аккаунта

Для создания аккаунта необходимо выполнить POST Запрос, содержащий 2 заголовка : 

. Login
. Password
	
include::{snippets}/AuthAdd/ok/http-request.adoc[]

В случае успешного создания нового аккаунта в ответе будет присутствовать токен безопасности,
необходимый для работы с апи


include::{snippets}/AuthAdd/ok/http-response.adoc[]


=== 2.2 Получение токена используя существующий аккаунт

Для получения токена необходимо выполнить GET запрос с аналогичными предыдущему пункту параметрами


include::{snippets}/AuthGet/ok/http-request.adoc[]

В случае успеха в ответе будет получен токен авторизации

include::{snippets}/AuthGet/ok/http-response.adoc[]

== 3 Пользователи

Для работы с пользователями используется адрес /api/v1/user

=== 3.1 Создание нового пользователя

Создание пользователя осуществляется по-средством отправки POST запроса, 
содержащим основные данные пользователя. На одном аккаунте может быть создано максимум 3 пользователя.


include::{snippets}/UserAdd/ok/http-request.adoc[]

В ответе будет содержаться информации о созданно пользователе, включая id, который он получил при добавлении
	

include::{snippets}/UserAdd/ok/http-response.adoc[]

=== 3.2 Получение списка пользователей у аккаунта

Для получения списка пользователя необходимо выполнить GET запрос

include::{snippets}/UserGetAll/ok/http-request.adoc[]

В ответе будет получен полный список пользователей у данного аккаунта

include::{snippets}/UserGetAll/ok/http-response.adoc[]


=== 3.3 Получение информации о конкретном пользователе

Получение информации о конкретном пользователе выполняется GET запросом по адресу /api/v1/user/id
, где id - идентификатор пользователя о котором необходимо получить информацию


include::{snippets}/UserGetById/ok/http-request.adoc[]


include::{snippets}/UserGetById/ok/http-response.adoc[]


=== 3.4 Обновление информации о существующем пользователе

Обновление информации по пользователе выполняется PUT запросом /api/v1/user/id , 
id - номер пользователя которого, профиль которого необходимо обновить.


include::{snippets}/UserUpdate/ok/http-request.adoc[]


include::{snippets}/UserUpdate/ok/http-response.adoc[]


=== 3.5 Добавление и получение фотографий пользователя
Для добавления фотографии пользователя, необходимо передать данные о фотографии , высоту , ширину и формат.
Для трёх последних используются заголовки. В случае если вам не требуются эти заголовки, вы можете записать в них нули.



include::{snippets}/UserPhotoAdd/ok/http-request.adoc[]


include::{snippets}/UserPhotoAdd/ok/http-response.adoc[]

Получить изображение пользователя можно используя url
api/v1/user/{id}/photo , где {id} - идентификатор пользователя


include::{snippets}/UserPhotoGet/ok/http-request.adoc[]


include::{snippets}/UserPhotoGet/ok/http-response.adoc[]

== 4 Список контактов

Получение списка контактов достигается с помощью GET запроса по адресу /api/v1/contact
Данный список состоит из всех пользователей с которыми когда-либо велась переписка. +
user-id - идентификатор пользователя, список которого необходимо получить


include::{snippets}/Contact/ok/http-request.adoc[]


include::{snippets}/Contact/ok/http-response.adoc[]

== 5 Сообщения

Работа с сообщениями производится по адресу /api/v1/message

=== 5.1 Отправка сообщений


include::{snippets}/MessageSend/ok/http-request.adoc[]


include::{snippets}/MessageSend/ok/http-response.adoc[]

=== 5.2 Получение сообщений от конкретного пользователя сообщений


include::{snippets}/MessageGet/ok/http-request.adoc[]


include::{snippets}/MessageGet/ok/http-response.adoc[]

=== 5.3 Получение сообщений от всех пользователей


include::{snippets}/MessagesAll/ok/http-request.adoc[]


include::{snippets}/MessagesAll/ok/http-response.adoc[]

=== 5.4 Выборка сообщений 

В случае когда необходимо получить сообщения начиная или заканчивая определённым временем, 
вы можете передать дополнительные параметры send_time , reversed , count
count - кол-во сообщений, которое будет получено в ответе. Это может быть полезно, если вы не хотите получать сразу все сообщения из истории
send_time - время, начиная с которого( или до которого) необходимо получить сообщения. Направление указывает заголовок reversed.
Если заголовок reversed == false, либо не указан, тогда будут получены все сообщения начиная с указанного времени
Если заголовок reversed == true, тогда будут получены все сообщения, полученные до этого времени.
Все три заголовка являются опциональными.

Пример получения 3х сообщений, отправленные после определённой даты 

include::{snippets}/MessagesDate/ok/http-request.adoc[]


include::{snippets}/MessagesDate/ok/http-response.adoc[]


Пример получения 3х сообщений, которые были отправлены до определённой даты 

include::{snippets}/MessagesDateBefore/ok/http-request.adoc[]


include::{snippets}/MessagesDateBefore/ok/http-response.adoc[]

=== 5.5 Подтверждение получения сообщений
Чтобы пометить сообщения из какого-то диалога как прочитанные, необходимо выполнить PUT запрос к /message/{id}/accept,
где {id} - идентификатор собеседника. Можно указать как конкретные id сообщений, которые можно пометить, так и время. Если не указывать ничего
все сообщения будут помечены как прочитанные. Пример ниже является избытычным, однако показывает все способы подтверждения. 


include::{snippets}/AcceptMessages/ok/http-request.adoc[]


include::{snippets}/AcceptMessages/ok/http-response.adoc[]

После этого сообщения, полученные от пользователя {id} до определённого времени с id 1,2,3 или 4 будут помечены как прочитанные.
Ниже приведён результата получение сообщений после подтверждения.


include::{snippets}/AcceptMessageResult/ok/http-response.adoc[]

== 6 Поиск

Возможен поиск по id пользователя, либо по имени пользователя

== 6.1 Поиск используя id

Поиск по id пользователя производится по адресу /search/id/{id}

include::{snippets}/SearchID/ok/http-request.adoc[]


include::{snippets}/SearchID/ok/http-response.adoc[]

== 6.1 Поиск используя имя пользователя

Поиск по id пользователя производится по адресу /search/username/{username}

При поиске основанном на имени пользователя возвращаются все пользователи,
у которых есть как минимум частичное совпадение

include::{snippets}/SearchUsername/ok/http-request.adoc[]


include::{snippets}/SearchUsername/ok/http-response.adoc[]
